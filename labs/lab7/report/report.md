---
## Front matter
title: "Отчет по лабораторной работе №7"
subtitle: "по дисциплине: Математическое моделирование"
author: "Ван И"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: false # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Продолжить знакомство с функционалом языка программирования Julia, дополнительных библиотек (DifferentialEquations, Plots), интерактивного блокнота Pluto, а также интерактивной командной строкой REPL. Продолжить ознакомление с языком моделирования Modelica и программным обеспечением OpenModelica. Используя эти средства, описать математическую модель рекламной компании.

# Задание

Постройте график распространения рекламы, математическая модель которой описывается следующим уравнением:

1. $\frac{dn}{dt} = (0.895+0.0000433n(t))(N-n(t))$

2. $\frac{dn}{dt} = (0.0000145+0.295n(t))(N-n(t))$

3. $\frac{dn}{dt} = (0.196 \cdot t + 0.699 \cdot t \cdot n(t))(N-n(t))$

При этом объем аудитории $N=1170$, в начальный момент о товаре знает $7$ человек. Для случая 2 определите в какой момент времени скорость распространения рекламы будет иметь максимальное значение.

# Теоретическое введение
## Модель рекламной кампании

__Модель рекламной кампании__ — математическая модель, описывающая скорость распространения информации о новом товаре какой-либо компании среди потенциальных покупателей. В нашем случае будем считать, что при распространении информации о товаре на покупателя, он сразу же готов купить рекламируемый товар.

Оценка скорости распространения информации о товаре важна при оценки прибыли от будущих продаж товара по сравнению с избытками издержек, потраченных на рекламу. Вначале расходы на рекламу могут превышать прибыль, но по мере увеличения числа продаж увеличивается прибыль. Однако реклама становится бесполезной, когда рынок насыщается.

Математическая модель рекламной кампании описывается следующим ОДУ:

$$\frac{dn}{dt} = (\alpha_1(t) + \alpha_2(t)n(t))(N-n(t)), $$

где $N$ — число потенциальных клиентов; $n(t)$ — число клиентов, информированных о товаре и готовых его купить; $\frac{dn}{dt}$ — изменение числа клиентов, информированных о товаре и готовых его купить, со временем; $\alpha_1(t)$ — величина, характеризующая интенсивность рекламной компании; $\alpha_2(t)$ — величина, характеризующая интенсивность т.н. «сарафанного радио».

При $\alpha_1(t)$ значительно большем, чем $\alpha_2(t)$, график зависимости $n(t)$ от $t$ будет являться экспоненциальным графиком, а математическая модель будет называться моделью Мальтуса.

При $\alpha_1(t)$ значительно меньшем, чем $\alpha_2(t)$, получим уравнение логистической кривой [@rudn].


## Уравнение модели Мальтуса

__Модель Мальтуса__ — это математическая модель, разработанная теоретиком демографии Томасом Мальтусом в XVIII веке, для описания изменения численности населения в течение времени. Мальтус утверждал, что население удваивается каждые 25 лет, а производство продовольствия может увеличиться только линейно. Следовательно, рост населения будет приводить к недостатку пищи и, в конечном итоге, к голоду, болезням и смерти, которые уменьшат численность населения до уровня, соответствующего доступным ресурсам [@studme].

Модель Мальтуса описывает экспоненциальный рост численности населения. Она основана на предположении, что скорость роста численности населения пропорциональна численности населения в данный момент времени. Если обозначить численность населения в момент времени $t$ через $P(t)$, то модель Мальтуса можно записать в следующей форме:

$$ \frac{dP}{dt} = r \cdot N, $$

где $dP/dt$ — скорость изменения численности населения со временем, $P$ — текущая численность населения, $r$ — коэффициент рождаемости.

Решением этого дифференциального уравнения является экспоненциальная функция:

$$ P(t) = P_0 \cdot e^{rt}, $$

где $P(t)$ — численность населения в момент времени $t$, $P_0$ — исходная численность населений, $r$ — темп прироста населения («мальтузианский параметр»).

Таким образом, модель Мальтуса описывает экспоненциальный рост численности населения, то есть увеличение численности населения со временем происходит не пропорционально, а с постоянной скоростью, и эта скорость также увеличивается со временем. Однако, следует отметить, что в реальной жизни экспоненциальный рост на неограниченном промежутке времени невозможен, так как имеются ограничения в ресурсах и пространстве, необходимых для поддержания роста численности населения.

Модель Мальтуса имеет множество ограничений: она не учитывает такие факторы, как миграция, изменения в общественной политике и технологическом прогрессе, которые также влияют на изменение численности населения. Несмотря на это, модель Мальтуса остается важным теоретическим инструментом в изучении демографии и популяционных процессов [@malthus].


## Уравнение логистической кривой

__Логистическое уравнение__ — это S-образная кривая (сигмоидальная кривая), изначально используемая при построении математических моделей, описывающих изменение размера популяции со временем с учетом ограничений, налагаемых окружающей средой. Уравнение было предложено Пьером Ферхюльстем в 1838 году [@log].

Логистическое уравнение имеет следующий вид:

$$\frac{dN}{dt} = rN(1-\frac{N}{K})$$

где $N$ — размер популяции в момент времени $t$, $r$ — скорость роста популяции (без учета ограничений), $K$ — предельная вместимость среды.

Первое слагаемое в скобках описывает скорость роста популяции, а второе - ограничивает этот рост учитывая, что на определенном уровне популяции возможности среды ограничивают скорость дальнейшего роста.

Важно отметить, что при малых значениях $N$, то есть когда популяция еще не насытила среду, рост популяции описывается экспоненциальной моделью (без второго слагаемого в скобках). Однако при увеличении размера популяции, ограничения среды начинают влиять на скорость роста, и популяция переходит на устойчивое состояние - точку равновесия, которая соответствует величине $K$.

Логистическое уравнение находит применение в различных областях, таких как экология, демография, экономика, теория управления и другие .


# Выполнение лабораторной работы
## Pluto.jl
### Задание №1-3

1. Пишем программу, воспроизводящую модель на языке программирования Julia. Подставляем коэффициенты $\alpha_1$ и $\alpha_2$ и изменяем период времени. Анализируем полученные графики (рис. @fig:01, @fig:02, @fig:03).

    ```Julia
    using Plots
    using DifferentialEquations

    a1 = 0.895
    a2 = 0.0000433

    N = 1170
    u0 = [7]

    T1 = (0.0, 10.0)

    function F!(du, u, p, t)
        du[1] = (a1 + a2*u[1])*(N - u[1])
    end

    p1 = ODEProblem(F!, u0, T1)
    s1 = solve(p1)

    plt1 = plot(s1, dpi = 150, size = (800, 400), xlabel = "time", ylabel = "n(t)")
    savefig(plt1, "img_lab_71_lj.png")

    a1 = 0.0000145
    a2 = 0.295

    T2 = (0.0, 0.02)

    p2 = ODEProblem(F!, u0, T2)
    s2 = solve(p2)

    plt2 = plot(s2, dpi = 150, size = (800, 400), xlabel = "time", ylabel = "n(t)")
    savefig(plt2, "img_lab_72_lj.png")

    function Ft!(du, u, p, t)
        du[1] = (a1 * sin(t) + a2* cos(t) * u[1])*(N - u[1])
    end

    a1 = 0.196 
    a2 = 0.699

    T3 = (0.0, 0.1)

    p3 = ODEProblem(Ft!, u0, T3)
    s3 = solve(p3)

    plt3 = plot(s3, dpi = 150, size = (800, 400), xlabel = "time", ylabel = "n(t)")
    savefig(plt3, "img_lab_73_lj.png")
    ```

    ![График задания 1 (Julia)](image/img_lab_71_lj.png){#fig:01 width=86%}
    
    ![График задания 2 (Julia)](image/img_lab_72_lj.png){#fig:02 width=86%}
    
    ![График задания 3 (Julia)](image/img_lab_73_lj.png){#fig:03 width=86%}


## Modelica
### Задание №1-3

1. По аналогии с Julia пишем программу, воспроизводящую модель рекламной кампании на языке моделирования Modelica с использованием ПО OpenModelica. Любуемся результатами (рис. @fig:04, @fig:05, @fig:06).
    
    ```Modelica
    model lab71
      constant Real a1 = 0.895;
      constant Real a2 = 0.0000433;
      constant Integer N = 1170;
      constant Integer n0 = 7;
      Real n(time);
    initial equation
      n = n0;
    equation
      der(n) = (a1 + a2*n)*(N - n);
    end lab71;
    ```
    
    ![График задания 1 (Modelica)](image/img_lab_71_mo.png){#fig:04 width=86%}
    
    ![График задания 2 (Modelica)](image/img_lab_72_mo.png){#fig:05 width=86%}
    
    ![График задания 3 (Modelica)](image/img_lab_73_mo.png){#fig:06 width=86%}


# Анализ результатов

На текущем примере построения математической модель рекламной кампании мы можем продолжить сравнивать язык программирования Julia и язык моделирования Modelica. Если быть откровенным, по сравнению с анализом результатов при выполнении предыдущей лабораторной работы изменения незначительны: тенденция к сглаживанию негативных моментов при выполнении лабораторной работы на языке программирования Julia по сравнению с языком моделирования Modelica продолжается. Со временем и с новыми заданиями, решаемыми при помощи библиотеки DifferentialEquations, скорость написания программ на Julia почти сравнялась с таковой скоростью при использовании Modelica.

На языке Julia можно явно найти момент времени, во время которого скорость изменения функции $n(t)$ (т.е. $\dot n$) максимальна, т.к. мы можем напрямую взаимодействовать со значениями производной в каждый момент времени, обусловленный шагом разбиения. Это позволяет достаточно легко находить максимальное значение производной на периоде, момент времени в этой точки, а также само значение функции $n(t)$ в этой точке.

При написании же программы на Modelica приходится вручную искать максимальное значение по графику производной функции $n(t)$.

С другой стороны, хотелось бы отметить, что в Modelica в разы удобнее составлять уравнения, т.к. все переменные, зависящие от времени, подписываются заданными ранее символами в отличие от Julia, где каждой переменной соответствует элемент массива. Такая реализация может запутать, что может привести к ошибкам, связанными с усидчивостью, при описании модели.

# Выводы

Продолжил знакомство с функционалом языка программирования Julia, дополнительных библиотек (DifferentialEquations, Plots). Продолжил ознакомление с языком моделирования Modelica и программным обеспечением OpenModelica. Используя эти средства, описал математическую модель рекламной кампании.


# Список литературы{.unnumbered}

::: {#refs}
:::
